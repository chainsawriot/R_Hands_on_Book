mtcars %>%
mean(hp, na.rm = T)
mtcars %>%
mean(.$hp, na.rm = T)
mtcars %>%
mean(.$hp)
mean(mtcars$hp)
mtcars %>%
mean(hp)
mtcars %>%
select(hp) %>%
mean()
mtcars %>%
select(hp) %>%
mean(.)
mtcars %>%
select(hp) %>%
mean(.)
mtcars %>%
select(hp)
mtcars %>%
select(hp) %>%
mean(.)
mtcars %>%
select(hp) %>%
mean(.$hp)
mtcars %>%
pull(hp) %>%
mean()
mtcars %>%
select(hp) %>%
mean()
mtcars %>%
pull(hp) %>%
mean()
mtcars %>%
select(hp)
mtcars %>%
select(hp) %>%
str()
mtcars %>%
select(hp) %>%
mean()
mtcars %>%
pull(hp) %>%
mean()
mtcars %>%
summarize(mean(hp))
mtcars %>%
summarize()
mtcars %>%
summarize(mean)
mtcars %>%
summarize(Mittelwert = mean(hp))
data %>%
str() %>%
summarize(mean (hp))
data %>%
str() %>%
summarize(mean(hp))
data %>%
summarize(mean(hp)) %>%
str()
data %>%
summarize(mean(hp))
mtcars %>%
str() %>%
summarize(mean(hp))
mtcars %>%
str() %>%
pull(hp) %>%
mean()
mtcars %>%
pull(hp) %>%
mean() %>%
str() %>%
mean(mtcars$hp)
head(vertrauen_institutionen$age) # <1>
vertrauen_institutionen <- daten %>%
select(age, pt01, pt02, pt03, pt04, pt06, pt07, pt08, pt09, pt10, pt11, pt12, pt14, pt15, pt19, pt20)
library(pacman)
p_load(haven,tidyr,dplyr)
daten <- read_dta("Datensatz/Allbus_2021.dta")
vertrauen_institutionen <- daten %>%
select(age, pt01, pt02, pt03, pt04, pt06, pt07, pt08, pt09, pt10, pt11, pt12, pt14, pt15, pt19, pt20)
head(vertrauen_institutionen$age) # <1>
View(vertrauen_institutionen)
vertrauen_institutionen$age # <1>
options(max.print = 100)
vertrauen_institutionen$age # <1>
options(max.print = 100)
vertrauen_institutionen$age
library(tidyverse)
daten <- haven::read_dta("Datensatz/Allbus_2021.dta") # <1>
install.packages("tidyverse")
daten <- haven::read_dta("Datensatz/Allbus_2021.dta")
View(daten)
library(labell)
library(labelled)
install.packages("labelled")
library(labelled)
View(daten)
str(daten)
dyplr
library(dplyr)
x <- daten %>% select(sex, yborn, pt01, pt02, pt03)
?label_attribute
get_value_labels(x)
get_value_labels(x$sex)
var_label(x$sex)
library(dplyr)
#x <- daten %>% select(sex, yborn, pt01, pt02, pt03)
colnames(daten)
var_label(x$sex)
var_label(x)
daten_auswahl <- daten %>%
select(sex, yborn, pt01, pt02, pt03)
xx <- var_label(x)
str(xx)
#str(xx)
unlist(xx)
y <- data.frame(unlist(xx))
y
y <- as.data.frame(unlist(xx))
y
y <- tibble(unlist(xx))
y
y <- as.data.frame(unlist(xx))
y
x <- var_label() %>% as.data.frame()
x <- daten_auswahl %>% var_label() %>% as.data.frame()
x <- daten_auswahl %>% var_label() %>% as.data.frame()
View(x)
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% t()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% tidyr::pivot_longer()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% tidyr::pivot_longer(.)
x <- daten_auswahl %>% var_label() %>% as.data.frame()
#x <- daten_auswahl %>% var_label() %>% as.data.frame()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% data.table::transpose()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% t()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% t() %>% tibble::rownames_to_column()
x <- daten_auswahl %>% var_label() %>% unlist() %>% t() %>% as.data.frame() %>% tibble::rownames_to_column()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% t() %>% tibble::rownames_to_column()
x <- daten_auswahl %>% var_label() %>% as.data.frame() %>% t()
x <- daten_auswahl %>% var_label() %>% unlist() %>% t()
x <- daten_auswahl %>% var_label() %>% unlist()
x
names(x)
daten_auswahl <- daten %>%
select(sex, yborn, pt01:pt05)
daten_auswahl <- daten %>%
select(sex, yborn, pt01:pt04)
variablen <- daten_auswahl %>%
var_label() %>%
unlist() %>%
;
variablen <- daten_auswahl %>%
var_label() %>%
unlist()
variablen
variablen <- daten_auswahl %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
t()
variablen
variablen <- daten_auswahl %>%
var_label() %>%
unlist() %>%
as.data.frame()
variablen
variablen <- daten_auswahl %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
tibble::rownames_to_column()
View(variablen)
variablen <- daten_auswahl %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
tibble::rownames_to_column("variable_name") %>%
rename("description" = ".")
variablen <- daten %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
tibble::rownames_to_column("variable_name") %>%
rename("description" = ".")
write_excel_csv2(variable, file = "Datensatz/ALLBUS_2021_variablen.csv")
# Datenvorvergarbeitung ALLBUS 2021
# Datenvorvergarbeitung ALLBUS 2021
library(dplyr)
library(tibble)
library(haven)
library(readr)
daten <- read_dta("Datensatz/Allbus_2021.dta")
# Name und Beschreibungen von Variablen extrahieren
variablen <- daten %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
rownames_to_column("variable_name") %>%
rename("description" = ".")
library(labelled)
# Name und Beschreibungen von Variablen extrahieren
variablen <- daten %>%
var_label() %>%
unlist() %>%
as.data.frame() %>%
rownames_to_column("variable_name") %>%
rename("description" = ".")
write_excel_csv2(variable, file = "Datensatz/ALLBUS_2021_variablen.csv")
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen.csv")
View(daten)
str(daten)
View(daten)
str(daten)
?na_if
starwars %>%
mutate(across(where(is.character), ~na_if(., "unknown")))
starwars
starwars %>%
mutate(across(where(is.character), ~na_if(., "unknown")))
starwars %>%
mutate(across(where(is.character), ~na_if(., "unknown")))
x <- starwars %>%
mutate(across(where(is.character), ~na_if(., "unknown")))
xx <- starwars
View(xx)
daten2 <- daten %>%
mutate(across(where(is.numeric()), ~na_if(., . < 0)))
daten2 <- daten %>%
mutate(across(where(is.numeric()), ~na_if(., < 0)))
daten2 <- daten %>%
mutate(across(where(is.numeric()), ~na_if(., .<0))
)
daten2 <- daten %>%
mutate(across(where(is.numeric()), ~na_if(., .<0)))
daten2 <- daten %>%
mutate(across(where(is.numeric(.)), ~na_if(., .<0)))
daten2 <- daten %>%
mutate(across(where(is.numeric), ~na_if(., .<0)))
daten_auswahl <- daten %>%
select(sex, yborn, pt01:pt04)
View(daten_auswahl)
daten_auswahl <- daten %>%
select(sex, yborn, pt01:pt04) %>%
mutate(across(where(is.numeric), ~ ifelse(.x < 0, NA, .x)))
daten2 <- daten %>%
#mutate(across(where(is.numeric), ~na_if(., .<0)))
mutate(across(where(is.numeric), ~ ifelse(.x < 0, NA, .x)))
View(daten2)
View(variablen)
sample_klein <- daten %>%
select(age, sex, lm01) %>%
slice_sample(n = 20)
View(sample_klein)
get_value_labels(sample_klein$age)
get_value_labels(sample_klein$sex)
get_value_labels(sample_klein$lm01)
?get_value_labels
x <- sample_klein$lm01
x
x <- sample_klein$lm01
abc <- lookfor(daten)
View(abc)
abc2 <- lookfor_to_long_format(daten)
View(abc2)
View(abc2)
abc2 <- lookfor_to_long_format(abc)
str(abc2)
abc3 <- convert_list_columns_to_character(abc2)
View(abc3)
View(abc2)
View(abc3)
variablen <- look_for(daten)
View(variablen)
#abc <- lookfor(daten)
?to_labelled
?haven::labelled
View(abc3)
sample_klein <- daten %>%
select(age, sex, lm01) %>%
slice_sample(n = 20)
sample_klein %>%
look_for() %>%
lookfor_to_long_format() %>%
convert_list_columns_to_character()
xyz <- sample_klein %>%
look_for() %>%
lookfor_to_long_format() %>%
convert_list_columns_to_character()
View(xyz)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(age, sex, lm01), as.factor()) %>%
slice_sample(n = 20)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01)), as_factor()) %>%
slice_sample(n = 20)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01)), as_factor) %>%
slice_sample(n = 20)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01), as_factor)) %>%
slice_sample(n = 20)
View(sample_klein)
str(sample_klein)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01), as_factor)) %>%
remove_labels() %>%
#remove_attributes("format.stata") %>%
slice_sample(n = 20)
str(sample_klein)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
str(sample_klein)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(where(is.character), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(age, sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
str(sample_klein)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
str(sample_klein)
levels(sample_klein$sex)
levels(sample_klein$lm01)
# simpler
variablen <- look_for(daten)
# inkl. antwortoptionen
variablen_optionen <- lookfor_to_long_format(variablen)
View(variablen_optionen)
# simpler
variablen <- daten %>%
look_for() %>%
select(pos, variable, label, value_labels)
# simpler
variablen <- daten %>%
look_for() %>%
select(pos, variable, label, value_labels)
# inkl. antwortoptionen
variablen_optionen <- daten %>%
look_for() %>%
lookfor_to_long_format() %>%
select(pos, variable, label, value_labels)
View(variablen_optionen)
str(variablen_optionen)
# Liste speichern
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen.csv")
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen_optionen.csv")
# Datenvorvergarbeitung ALLBUS 2021
# Libraries
library(dplyr)
library(tibble)
library(haven)
library(readr)
library(labelled)
# Daten einlesen und NAs korrigieren
daten <- read_dta("Datensatz/Allbus_2021.dta") %>%
mutate(across(where(is.numeric), ~ ifelse(.x < 0, NA, .x)))
# Name und Beschreibungen von Variablen extrahieren
#variablen <- daten %>%
#  var_label() %>%
#  unlist() %>%
#  as.data.frame() %>%
#  rownames_to_column("variable_name") %>%
#  rename("description" = ".")
# simpler
variablen <- daten %>%
look_for() %>%
select(pos, variable, label, value_labels)
# inkl. antwortoptionen
variablen_optionen <- daten %>%
look_for() %>%
lookfor_to_long_format() %>%
select(pos, variable, label, value_labels)
# Liste speichern
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen.csv")
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen_optionen.csv")
write_excel_csv2(variablen_optionen, file = "Datensatz/ALLBUS_2021_variablen_optionen.csv")
# Subsamples erstellen
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
View(sample_klein)
View(daten)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(sex, lm01), as_factor))
View(sample_klein)
View(daten)
str(daten)
View(variablen_optionen)
View(variablen)
# Daten einlesen und NAs korrigieren
daten <- read_dta("Datensatz/Allbus_2021.dta")
# simpler
variablen <- daten %>%
look_for() %>%
select(pos, variable, label, value_labels)
# inkl. antwortoptionen
variablen_optionen <- daten %>%
look_for() %>%
lookfor_to_long_format() %>%
select(pos, variable, label, value_labels)
# Liste speichern
write_excel_csv2(variablen, file = "Datensatz/ALLBUS_2021_variablen.csv")
write_excel_csv2(variablen_optionen, file = "Datensatz/ALLBUS_2021_variablen_optionen.csv")
View(variablen)
View(variablen_optionen)
# Subsamples erstellen
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
mutate(across(c(sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
View(sample_klein)
sample_klein <- daten %>%
select(age, sex, lm01) %>%
rename(alter = age,
geschlecht = sex,
fernsehkonsum = lm01) %>%
mutate(across(c(sex, lm01), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
rename(alter = age,
geschlecht = sex,
fernsehkonsum = lm01) %>%
mutate(across(c(geschlecht, fernsehkonsum), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
library(naniar)
install.packages("naniar")
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
rename(alter = age,
geschlecht = sex,
fernsehkonsum = lm01) %>%
replace_with_na_all(condition = ~.x < 0) %>%
mutate(across(c(geschlecht, fernsehkonsum), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
library(naniar)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
rename(alter = age,
geschlecht = sex,
fernsehkonsum = lm01) %>%
replace_with_na_all(condition = ~.x < 0) %>%
mutate(across(c(geschlecht, fernsehkonsum), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata") %>%
slice_sample(n = 20)
View(sample_klein)
# Wenige Fälle, wenige Variablen
sample_klein <- daten %>%
select(age, sex, lm01) %>%
slice_sample(n = 20) %>%
rename(alter = age,
geschlecht = sex,
fernsehkonsum = lm01) %>%
replace_with_na_all(condition = ~.x < 0) %>%
mutate(across(c(geschlecht, fernsehkonsum), as_factor)) %>%
remove_labels() %>%
remove_attributes("format.stata")
View(sample_klein)
View(sample_klein)
